<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · LombScargle</title><meta name="title" content="Examples · LombScargle"/><meta property="og:title" content="Examples · LombScargle"/><meta property="twitter:title" content="Examples · LombScargle"/><meta name="description" content="Documentation for LombScargle."/><meta property="og:description" content="Documentation for LombScargle."/><meta property="twitter:description" content="Documentation for LombScargle."/><meta property="og:url" content="https://juliaastro.org/Cosmology/stable/examples/"/><meta property="twitter:url" content="https://juliaastro.org/Cosmology/stable/examples/"/><link rel="canonical" href="https://juliaastro.org/Cosmology/stable/examples/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LombScargle</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../usage/">Usage</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Signal-with-Uncertainties"><span>Signal with Uncertainties</span></a></li><li><a class="tocitem" href="#Find-Highest-Power-and-Associated-Frequencies-and-Periods"><span>Find Highest Power and Associated Frequencies and Periods</span></a></li><li><a class="tocitem" href="#Significance-of-the-Peaks"><span>Significance of the Peaks</span></a></li><li><a class="tocitem" href="#Find-the-Best-Fitting-Model"><span>Find the Best-Fitting Model</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaAstro/LombScargle.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaAstro/LombScargle.jl/blob/master/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><p>Here is an example of a noisy periodic signal (<span>$\sin(\pi t) + 1.5\cos(2\pi t)$</span>) sampled at unevenly spaced times.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using LombScargle</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Random</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Random.seed!(42); # make plots reproducible</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ntimes = 1001;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; t = range(0.01, 10pi, length = ntimes) # Observation times</code><code class="nohighlight hljs ansi" style="display:block;">0.01:0.03140592653589793:31.41592653589793</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; t += step(t)*rand(ntimes); # Randomize times</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; s = sinpi.(t) .+ 1.5cospi.(2t) .+ rand(ntimes); # The signal</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plan = LombScargle.plan(t, s); # Pre-plan the periodogram</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; pgram = lombscargle(plan) # Compute the periodogram</code><code class="nohighlight hljs ansi" style="display:block;">LombScargle.Periodogram{Float64, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}, Vector{Float64}}([0.0009002061856020596, 0.0008836113626863781, 0.0008495252318279351, 0.0007945083538758122, 0.0007052919678129175, 0.0005425637744200134, 0.0002821925162241195, 5.119517579364273e-5, 3.589360431210285e-5, 0.00019032755028405127  …  0.0011197360659888319, 0.0013600579636300514, 0.0009567336181250871, 0.00022198735604679484, 7.888602659701585e-5, 0.0010836848233666905, 0.0026394015757926293, 0.0034258931687385576, 0.0027428417988911587, 0.0011372880435844058], 0.0031823671601760094:0.006364734320352019:79.63237344908428, [0.015451270375901948, 0.051508007716585986, 0.08093296934439527, 0.10944493943658266, 0.15217510074016963, 0.18219939042833327, 0.21070470491330284, 0.25505298746255434, 0.2920490151715063, 0.2956190459595937  …  31.143038468604786, 31.164857936510924, 31.20507145945872, 31.233375392399598, 31.271122085204944, 31.314799568543375, 31.344062482974675, 31.380022287634237, 31.38983942755385, 31.438601072634807], :standard)</code></pre><p>You can plot the result, for example with <a href="https://github.com/tbreloff/Plots.jl">Plots</a> package. Use <a href="../usage/#LombScargle.freqpower"><code>freqpower</code></a> function to get the frequency grid and the power of the periodogram as a 2-tuple.</p><pre><code class="language-julia hljs">using Plots
plot(freqpower(pgram)...)</code></pre><img src="09456a56.svg" alt="Example block output"/><p>You can also plot the power vs the period, instead of the frequency, with <a href="../usage/#LombScargle.periodpower"><code>periodpower</code></a>:</p><pre><code class="language-julia hljs">using Plots
plot(periodpower(pgram)...)
xlabel!(&quot;Period&quot;)
ylabel!(&quot;Lomb–Scargle power&quot;)</code></pre><img src="b65d991f.svg" alt="Example block output"/><div class="admonition is-warning" id="Warning-93ab292003a633e5"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-93ab292003a633e5" title="Permalink"></a></header><div class="admonition-body"><p>If you do not fit for the mean of the signal (<code>fit_mean=false</code> keyword to <a href="../usage/#LombScargle.lombscargle-Tuple{AbstractVector{&lt;:Real}, Vararg{Any}}"><code>lombscargle</code></a> function) without centering the data (<code>center_data=false</code>) you can get inaccurate results. For example, spurious peaks at low frequencies can appear and the real peaks lose power:</p><pre><code class="language-julia hljs">plot(freqpower(lombscargle(t, s, fit_mean=false, center_data=false))...)</code></pre><img src="100ddc96.svg" alt="Example block output"/></div></div><div class="admonition is-success" id="Tip-96282294e7c3b20e"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-96282294e7c3b20e" title="Permalink"></a></header><div class="admonition-body"><p>You can tune the frequency grid with appropriate keywords to <a href="../usage/#LombScargle.lombscargle-Tuple{AbstractVector{&lt;:Real}, Vararg{Any}}"><code>lombscargle</code></a> function. For example, in order to increase the sampling increase <code>samples_per_peak</code>, and set <code>maximum_frequency</code> to lower values in order to narrow the frequency range:</p><pre><code class="language-julia hljs">plot(freqpower(lombscargle(t, s, samples_per_peak=20, maximum_frequency=1.5))...)</code></pre><img src="a2cbd389.svg" alt="Example block output"/><p>If you simply want to use your own frequency grid, directly set the <code>frequencies</code> keyword:</p><pre><code class="language-julia hljs">plot(freqpower(lombscargle(t, s, frequencies=0.001:1e-3:1.5))...)</code></pre><img src="fcf38e87.svg" alt="Example block output"/></div></div><h2 id="Signal-with-Uncertainties"><a class="docs-heading-anchor" href="#Signal-with-Uncertainties">Signal with Uncertainties</a><a id="Signal-with-Uncertainties-1"></a><a class="docs-heading-anchor-permalink" href="#Signal-with-Uncertainties" title="Permalink"></a></h2><p>The generalised Lomb–Scargle periodogram is able to handle a signal with uncertainties, and they will be used as weights in the algorithm.  The uncertainties can be passed either as the third optional argument <code>errors</code> to <a href="../usage/#LombScargle.lombscargle-Tuple{AbstractVector{&lt;:Real}, Vararg{Any}}"><code>lombscargle</code></a> or by providing this function with a <code>signal</code> vector of type <code>Measurement</code> (from <a href="https://github.com/JuliaPhysics/Measurements.jl">Measurements.jl</a> package).</p><pre><code class="language-julia hljs">using Measurements, Plots
ntimes = 1001
t = range(0.01, stop = 10pi, length = ntimes)
s = sinpi.(2t)
errors = rand(0.1:1e-3:4.0, ntimes)
# Run one of the two following equivalent commands
plot(freqpower(lombscargle(t, s, errors, maximum_frequency=1.5))...)
plot(freqpower(lombscargle(t, measurement.(s, errors), maximum_frequency=1.5))...)</code></pre><img src="fd737277.svg" alt="Example block output"/><p>This is the plot of the power versus the period:</p><pre><code class="language-julia hljs"># Run one of the two following equivalent commands
plot(periodpower(lombscargle(t, s, errors, maximum_frequency=1.5))...)
plot(periodpower(lombscargle(t, measurement(s, errors), maximum_frequency=1.5))...)</code></pre><img src="6082c97b.svg" alt="Example block output"/><p>We recall that the generalised Lomb–Scargle algorithm is used when the <code>fit_mean</code> optional keyword to <a href="../usage/#LombScargle.lombscargle-Tuple{AbstractVector{&lt;:Real}, Vararg{Any}}"><code>lombscargle</code></a> is <code>true</code> if no error is provided, instead it is always used if the signal has uncertainties.</p><h2 id="Find-Highest-Power-and-Associated-Frequencies-and-Periods"><a class="docs-heading-anchor" href="#Find-Highest-Power-and-Associated-Frequencies-and-Periods">Find Highest Power and Associated Frequencies and Periods</a><a id="Find-Highest-Power-and-Associated-Frequencies-and-Periods-1"></a><a class="docs-heading-anchor-permalink" href="#Find-Highest-Power-and-Associated-Frequencies-and-Periods" title="Permalink"></a></h2><p><a href="../usage/#LombScargle.findmaxfreq"><code>findmaxfreq</code></a> function tells you the frequencies with the highest power in the periodogram (and you can get the period by taking its inverse):</p><pre><code class="language-julia-repl hljs">julia&gt; t = range(0, stop = 10, length = 1001);

julia&gt; s = sinpi.(t);

julia&gt; plan = LombScargle.plan(t, s); # Plan the periodogram

julia&gt; p = lombscargle(plan);

julia&gt; findmaxperiod(p) # Period with highest power
1-element Vector{Float64}:
 0.004987779939149084

julia&gt; findmaxfreq(p) # Frequency with the highest power
1-element Vector{Float64}:
 200.49</code></pre><p>This peak is at high frequencies, very far from the expected value of the period of 2. In order to find the real peak, you can either narrow the ranges in order to exclude higher armonics</p><pre><code class="language-julia-repl hljs">julia&gt; findmaxperiod(p, [1, 10]) # Limit the search to periods in [1, 10]
1-element Vector{Float64}:
 2.0408163265306123

julia&gt; findmaxfreq(p, [0.1, 1]) # Limit the search to frequencies in [0.1, 1]
1-element Vector{Float64}:
 0.49</code></pre><p>or pass the <code>threshold</code> argument to <a href="../usage/#LombScargle.findmaxfreq"><code>findmaxfreq</code></a> or <a href="../usage/#LombScargle.findmaxperiod"><code>findmaxperiod</code></a>. You can use <a href="../usage/#LombScargle.findmaxpower"><code>findmaxpower</code></a> to discover the highest power in the periodogram:</p><pre><code class="language-julia-repl hljs">julia&gt; findmaxpower(p)
0.9996235276303144

julia&gt; findmaxperiod(p, 0.95)
10-element Vector{Float64}:
 2.0408163265306123
 1.9607843137254901
 0.010051261433309882
 0.010049241282283187
 0.009951238929246691
 0.009949258780220873
 0.005012782595618828
 0.005012280086211218
 0.004987779939149084
 0.004987282429804

julia&gt; findmaxfreq(p, 0.95)
10-element Vector{Float64}:
   0.49
   0.51
  99.49
  99.51
 100.49
 100.51
 199.49
 199.51
 200.49
 200.51</code></pre><p>The first peak is the real one, the other double peaks appear at higher armonics.</p><div class="admonition is-success" id="Tip-b4fd0a81d84ac55b"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-b4fd0a81d84ac55b" title="Permalink"></a></header><div class="admonition-body"><p>Usually, plotting the periodogram can give you a clearer idea of what&#39;s going on.</p></div></div><h2 id="Significance-of-the-Peaks"><a class="docs-heading-anchor" href="#Significance-of-the-Peaks">Significance of the Peaks</a><a id="Significance-of-the-Peaks-1"></a><a class="docs-heading-anchor-permalink" href="#Significance-of-the-Peaks" title="Permalink"></a></h2><p>The significance of the peaks in the Lomb–Scargle periodogram can be assessed by measuring the <a href="#false-alarm-probability">False-Alarm Probability</a>. Analytic expressions of this quantity and its inverse can be obtained with the <a href="../usage/#LombScargle.fap-Tuple{LombScargle.Periodogram, Real}"><code>fap</code></a> and <a href="../usage/#LombScargle.fapinv-Tuple{LombScargle.Periodogram, Real}"><code>fapinv</code></a> functions, respectively.</p><pre><code class="language-julia-repl hljs">julia&gt; t = linspace(0.01, 20, samples_per_peak = 10);

julia&gt; s = sinpi.(e.*t).^2 .- cos.(5t).^4;

julia&gt; plan = LombScargle.plan(t, s);

julia&gt; p = lombscargle(plan);

# Find the false-alarm probability for the highest peak.
julia&gt; fap(p, 0.3)
0.028198095962262748</code></pre><p>Thus, a peak with power <span>$0.3$</span> has a probability of <span>$0.028$</span> that it is due to noise only. A quantity that is often used is the inverse of the false-alarm probability as well: what is the minimum power whose false-alarm probability is lower than the given probability? For example, if you want to know the minimum power for which the false-alarm probability is at most <span>$0.01$</span> you can use:</p><pre><code class="language-julia-repl hljs">julia&gt; fapinv(p, 0.01)
0.3304696923786712</code></pre><p>As we already noted, analytic expressions of the false-alarm probability and its inverse may not be reliable if your data does not satisfy specific assumptions. A better way to calculate this quantity is to use statistical methods. One of this is bootstrapping. In <code>LombScargle.jl</code>, you can use the function <a href="../usage/#LombScargle.bootstrap"><code>LombScargle.bootstrap</code></a> to create a bootstrap sample and then you can calculate the false-alarm probability and its inverse using this sample.</p><div class="admonition is-success" id="Tip-a4fee7fe2d5c3483"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-a4fee7fe2d5c3483" title="Permalink"></a></header><div class="admonition-body"><p>When applying the bootstrap method you should use the same options you used to perform the periodogram on your data. Using the same periodogram plan you used to compute the periodogram will ensure that you use the same options. However, note that the fast method gives approximate results that for some frequencies may not be reliable (they can go outside the range <span>$[0, 1]$</span> for the standard normalization). More robust results can be obtained with the <code>fast = false</code> option.</p></div></div><p>Create a bootstrap sample with 10000 resamplings of the original data, re-using the same periodogram plan.  The larger the better. This may take some minutes.</p><pre><code class="language-julia-repl hljs">julia&gt; b = LombScargle.bootstrap(10000, plan)</code></pre><p>Calculate the false-alarm probability of a peak with power 0.3 using this bootstrap sample.</p><pre><code class="language-julia-repl hljs">julia&gt; fap(b, 0.3)
0.0209</code></pre><p>Calculate the lowest power that has probability less than 0.01 in this bootstrap sample.</p><pre><code class="language-julia-repl hljs">julia&gt; fapinv(b, 0.01)
0.3268290388848437</code></pre><p>If you query <a href="../usage/#LombScargle.fapinv-Tuple{LombScargle.Periodogram, Real}"><code>fapinv</code></a> with a too low probability, the corresponding power cannot be determined and you will get <code>NaN</code> as result.</p><pre><code class="language-julia-repl hljs">julia&gt; fapinv(b, 1e-5)
NaN</code></pre><p>If you want to find the power corresponding to a false-alarm probability of <span>$\text{prob} = 10^{-5}$</span>, you have to create a new bootstrap sample with <span>$N$</span> resamplings so that <span>$N\cdot\text{prob}$</span> can be rounded to an integer larger than or equal to one (for example <span>$N = 10^{5}$</span>).</p><h2 id="Find-the-Best-Fitting-Model"><a class="docs-heading-anchor" href="#Find-the-Best-Fitting-Model">Find the Best-Fitting Model</a><a id="Find-the-Best-Fitting-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Find-the-Best-Fitting-Model" title="Permalink"></a></h2><p>The <a href="../usage/#LombScargle.model"><code>LombScargle.model</code></a> function can help you to test whether a certain frequency fits well your data.</p><pre><code class="language-julia hljs">using LombScargle
using Random
using Plots
Random.seed!(42)
t = range(0.01, stop = 10pi, length = 1000) # Observation times
s = sinpi.(t) .+ 1.2cospi.(t) .+ 0.3rand(length(t)) # The noisy signal
# Pick-up the best frequency
f = findmaxfreq(lombscargle(t, s, maximum_frequency=10, samples_per_peak=20))[1]
t_fit = range(0, stop = 1, length = 50)
s_fit = LombScargle.model(t, s, f, t_fit/f) # Determine the model
scatter(mod.(t.*f, 1), s, lab=&quot;Phased data&quot;, title=&quot;Best Lomb-Scargle frequency: $f&quot;)
plot!(t_fit, s_fit, lab=&quot;Best-fitting model&quot;, linewidth=4)</code></pre><img src="83018aa9.svg" alt="Example block output"/><div class="admonition is-success" id="Tip-e0c26b6ec6022ef9"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-e0c26b6ec6022ef9" title="Permalink"></a></header><div class="admonition-body"><p>If there are more than one dominant frequency you may need to consider more models. This task may require some work and patience. Plot the periodogram in order to find the best frequencies.</p><pre><code class="language-julia hljs">using LombScargle
using Random
using Plots
Random.seed!(42)
t = range(0.01, stop = 5, length = 1000) # Observation times
s = sinpi.(2t) .+ 1.2cospi.(4t) .+ 0.3rand(length(t)) # Noisy signal
plan = LombScargle.plan(t, s, samples_per_peak=50)
p = lombscargle(plan)
# After plotting the periodogram, you discover
# that it has two prominent peaks around 1 and 2.
f1 = findmaxfreq(p, [0.8, 1.2])[1] # Get peak frequency around 1
f2 = findmaxfreq(p, [1.8, 2.2])[1] # Get peak frequency around 2
fit1 = LombScargle.model(t, s, f1) # Determine the first model
fit2 = LombScargle.model(t, s, f2) # Determine the second model
scatter(t, s, lab=&quot;Data&quot;, title=&quot;Best-fitting Lomb-Scargle model&quot;)
plot!(t, fit1 + fit2, lab=&quot;Best-fitting model&quot;, linewidth=4)</code></pre><img src="785ed03f.svg" alt="Example block output"/></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../usage/">« Usage</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 18 August 2025 10:14">Monday 18 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
